{"version":3,"sources":["../../../../src/modules/fiscal/dto/predict-tax.dto.ts"],"sourcesContent":["import { IsEnum, IsString, IsNumber, IsOptional, IsDateString, Min } from 'class-validator';\nimport { Type } from 'class-transformer';\nimport { ApiProperty, ApiPropertyOptional } from '@nestjs/swagger';\n\nexport enum ProspectiveTransactionType {\n  SELL = 'SELL',\n  BUY = 'BUY',\n}\n\nexport class PredictTaxImpactDto {\n  @ApiProperty({\n    description: 'Type of prospective transaction',\n    enum: ProspectiveTransactionType,\n    example: 'SELL',\n  })\n  @IsEnum(ProspectiveTransactionType)\n  transactionType: ProspectiveTransactionType;\n\n  @ApiProperty({\n    description: 'Crypto asset symbol',\n    example: 'BTC',\n  })\n  @IsString()\n  asset: string;\n\n  @ApiProperty({\n    description: 'Amount of crypto asset',\n    example: 0.5,\n  })\n  @IsNumber()\n  @Min(0)\n  @Type(() => Number)\n  amount: number;\n\n  @ApiProperty({\n    description: 'Price in EUR per unit',\n    example: 45000,\n  })\n  @IsNumber()\n  @Min(0)\n  @Type(() => Number)\n  priceEur: number;\n\n  @ApiPropertyOptional({\n    description: 'Date of prospective sale/purchase (defaults to current date)',\n    example: '2025-01-15',\n  })\n  @IsOptional()\n  @IsDateString()\n  dateOfSale?: string;\n}\n\nexport class ConsumedLotDto {\n  @ApiProperty({ description: 'Acquisition date of the lot' })\n  acquisitionDate: Date;\n\n  @ApiProperty({ description: 'Quantity consumed from this lot' })\n  quantity: number;\n\n  @ApiProperty({ description: 'Cost basis per unit in EUR' })\n  costBasisPerUnit: number;\n\n  @ApiProperty({ description: 'Total cost basis in EUR' })\n  totalCostBasis: number;\n\n  @ApiProperty({ description: 'Capital gain/loss from this lot in EUR' })\n  gainLoss: number;\n\n  @ApiProperty({ description: 'Holding period in days' })\n  holdingPeriodDays: number;\n}\n\nexport class TaxPredictionResponseDto {\n  @ApiProperty({\n    description: 'Total capital gain/loss in EUR',\n    example: 5234.5,\n  })\n  capitalGain: number;\n\n  @ApiProperty({\n    description: 'Estimated tax owed in EUR',\n    example: 1099.25,\n  })\n  taxOwed: number;\n\n  @ApiProperty({\n    description: 'Effective IRPF tax rate applied (%)',\n    example: 21,\n  })\n  effectiveTaxRate: number;\n\n  @ApiProperty({\n    description: 'Lots consumed by FIFO method',\n    type: [ConsumedLotDto],\n  })\n  lotsConsumed: ConsumedLotDto[];\n\n  @ApiProperty({\n    description: 'AI-generated recommendation',\n    example: 'Consider holding for more than 1 year to benefit from potential future tax advantages',\n  })\n  recommendation: string;\n\n  @ApiProperty({\n    description: 'Total proceeds from sale in EUR',\n    example: 22500,\n  })\n  totalProceeds: number;\n\n  @ApiProperty({\n    description: 'Total acquisition cost in EUR',\n    example: 17265.5,\n  })\n  totalAcquisitionCost: number;\n}\n"],"names":["ConsumedLotDto","PredictTaxImpactDto","ProspectiveTransactionType","TaxPredictionResponseDto","description","enum","example","Number","type"],"mappings":";;;;;;;;;;;QAoDaA;eAAAA;;QA3CAC;eAAAA;;QALDC;eAAAA;;QAoECC;eAAAA;;;gCAxE6D;kCACrD;yBAC4B;;;;;;;;;;AAE1C,IAAA,AAAKD,oDAAAA;;;WAAAA;;AAKL,IAAA,AAAMD,sBAAN,MAAMA;AAyCb;;;QAvCIG,aAAa;QACbC,MAAMH;QACNI,SAAS;;;;;;;QAMTF,aAAa;QACbE,SAAS;;;;;;;QAMTF,aAAa;QACbE,SAAS;;;;oCAICC;;;;;QAIVH,aAAa;QACbE,SAAS;;;;oCAICC;;;;;QAIVH,aAAa;QACbE,SAAS;;;;;;AAON,IAAA,AAAMN,iBAAN,MAAMA;AAkBb;;;QAjBiBI,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;;;QAGbA,aAAa;;;;AAIvB,IAAA,AAAMD,2BAAN,MAAMA;AA0Cb;;;QAxCIC,aAAa;QACbE,SAAS;;;;;;QAKTF,aAAa;QACbE,SAAS;;;;;;QAKTF,aAAa;QACbE,SAAS;;;;;;QAKTF,aAAa;QACbI,MAAM;YAACR;SAAe;;;;;;QAKtBI,aAAa;QACbE,SAAS;;;;;;QAKTF,aAAa;QACbE,SAAS;;;;;;QAKTF,aAAa;QACbE,SAAS"}