{"version":3,"sources":["../../../../src/modules/auth/strategies/local.strategy.ts"],"sourcesContent":["import { Injectable, UnauthorizedException } from '@nestjs/common';\nimport { PassportStrategy } from '@nestjs/passport';\nimport { Strategy } from 'passport-local';\nimport { AuthService } from '../auth.service.js';\n\n@Injectable()\nexport class LocalStrategy extends PassportStrategy(Strategy) {\n  constructor(private authService: AuthService) {\n    super({ usernameField: 'email' });\n  }\n\n  async validate(\n    email: string,\n    password: string,\n  ): Promise<{ id: string; email: string }> {\n    const user = await this.authService.validateUser(email, password);\n    if (!user) {\n      throw new UnauthorizedException('Invalid email or password');\n    }\n    return user;\n  }\n}\n"],"names":["LocalStrategy","PassportStrategy","Strategy","validate","email","password","user","authService","validateUser","UnauthorizedException","usernameField"],"mappings":";;;;+BAMaA;;;eAAAA;;;wBANqC;0BACjB;+BACR;6BACG;;;;;;;;;;AAGrB,IAAA,AAAMA,gBAAN,MAAMA,sBAAsBC,IAAAA,0BAAgB,EAACC,uBAAQ;IAK1D,MAAMC,SACJC,KAAa,EACbC,QAAgB,EACwB;QACxC,MAAMC,OAAO,MAAM,IAAI,CAACC,WAAW,CAACC,YAAY,CAACJ,OAAOC;QACxD,IAAI,CAACC,MAAM;YACT,MAAM,IAAIG,6BAAqB,CAAC;QAClC;QACA,OAAOH;IACT;IAbA,YAAY,AAAQC,WAAwB,CAAE;QAC5C,KAAK,CAAC;YAAEG,eAAe;QAAQ,SADbH,cAAAA;IAEpB;AAYF"}