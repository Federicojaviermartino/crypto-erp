{"version":3,"sources":["../../../src/modules/companies/companies.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Patch,\n  Delete,\n  Body,\n  Param,\n  UseGuards,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n} from '@nestjs/swagger';\nimport { CompaniesService } from './companies.service.js';\nimport { CreateCompanyDto, UpdateCompanyDto } from './dto/index.js';\nimport { JwtAuthGuard } from '../../common/guards/jwt-auth.guard.js';\nimport { CurrentUser, JwtPayload } from '../../common/index.js';\n\n@ApiTags('companies')\n@ApiBearerAuth('access-token')\n@UseGuards(JwtAuthGuard)\n@Controller('companies')\nexport class CompaniesController {\n  constructor(private companiesService: CompaniesService) {}\n\n  @Post()\n  @ApiOperation({ summary: 'Create a new company with PGC chart of accounts' })\n  @ApiResponse({ status: 201, description: 'Company created with seed data' })\n  async create(@CurrentUser() user: JwtPayload, @Body() dto: CreateCompanyDto) {\n    return this.companiesService.create(user.sub, dto);\n  }\n\n  @Get()\n  @ApiOperation({ summary: 'List all companies for current user' })\n  @ApiResponse({ status: 200, description: 'List of companies' })\n  async findAll(@CurrentUser() user: JwtPayload) {\n    return this.companiesService.findAllByUser(user.sub);\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get company by ID' })\n  @ApiResponse({ status: 200, description: 'Company details' })\n  @ApiResponse({ status: 404, description: 'Company not found' })\n  async findOne(@CurrentUser() user: JwtPayload, @Param('id') id: string) {\n    return this.companiesService.findById(id, user.sub);\n  }\n\n  @Patch(':id')\n  @ApiOperation({ summary: 'Update company' })\n  @ApiResponse({ status: 200, description: 'Company updated' })\n  @ApiResponse({ status: 403, description: 'Insufficient permissions' })\n  async update(\n    @CurrentUser() user: JwtPayload,\n    @Param('id') id: string,\n    @Body() dto: UpdateCompanyDto,\n  ) {\n    return this.companiesService.update(id, user.sub, dto);\n  }\n\n  @Delete(':id')\n  @ApiOperation({ summary: 'Soft delete company (OWNER only)' })\n  @ApiResponse({ status: 200, description: 'Company deleted' })\n  @ApiResponse({ status: 403, description: 'Only OWNER can delete' })\n  async delete(@CurrentUser() user: JwtPayload, @Param('id') id: string) {\n    return this.companiesService.delete(id, user.sub);\n  }\n\n  @Post(':id/default')\n  @ApiOperation({ summary: 'Set company as default for user' })\n  @ApiResponse({ status: 200, description: 'Default company updated' })\n  async setDefault(@CurrentUser() user: JwtPayload, @Param('id') id: string) {\n    return this.companiesService.setDefault(id, user.sub);\n  }\n}\n"],"names":["CompaniesController","create","user","dto","companiesService","sub","findAll","findAllByUser","findOne","id","findById","update","delete","setDefault","summary","status","description"],"mappings":";;;;+BAyBaA;;;eAAAA;;;wBAhBN;yBAMA;kCAC0B;uBACkB;8BACtB;wBACW;;;;;;;;;;;;;;;AAMjC,IAAA,AAAMA,sBAAN,MAAMA;IAGX,MAGMC,OAAO,AAAeC,IAAgB,EAAE,AAAQC,GAAqB,EAAE;QAC3E,OAAO,IAAI,CAACC,gBAAgB,CAACH,MAAM,CAACC,KAAKG,GAAG,EAAEF;IAChD;IAEA,MAGMG,QAAQ,AAAeJ,IAAgB,EAAE;QAC7C,OAAO,IAAI,CAACE,gBAAgB,CAACG,aAAa,CAACL,KAAKG,GAAG;IACrD;IAEA,MAIMG,QAAQ,AAAeN,IAAgB,EAAE,AAAaO,EAAU,EAAE;QACtE,OAAO,IAAI,CAACL,gBAAgB,CAACM,QAAQ,CAACD,IAAIP,KAAKG,GAAG;IACpD;IAEA,MAIMM,OACJ,AAAeT,IAAgB,EAC/B,AAAaO,EAAU,EACvB,AAAQN,GAAqB,EAC7B;QACA,OAAO,IAAI,CAACC,gBAAgB,CAACO,MAAM,CAACF,IAAIP,KAAKG,GAAG,EAAEF;IACpD;IAEA,MAIMS,OAAO,AAAeV,IAAgB,EAAE,AAAaO,EAAU,EAAE;QACrE,OAAO,IAAI,CAACL,gBAAgB,CAACQ,MAAM,CAACH,IAAIP,KAAKG,GAAG;IAClD;IAEA,MAGMQ,WAAW,AAAeX,IAAgB,EAAE,AAAaO,EAAU,EAAE;QACzE,OAAO,IAAI,CAACL,gBAAgB,CAACS,UAAU,CAACJ,IAAIP,KAAKG,GAAG;IACtD;IAjDA,YAAY,AAAQD,gBAAkC,CAAE;aAApCA,mBAAAA;IAAqC;AAkD3D;;;;QA/CkBU,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;;QAUzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QAMzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa"}