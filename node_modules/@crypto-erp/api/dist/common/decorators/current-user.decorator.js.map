{"version":3,"sources":["../../../src/common/decorators/current-user.decorator.ts"],"sourcesContent":["import { createParamDecorator, ExecutionContext } from '@nestjs/common';\nimport { Request } from 'express';\n\n/**\n * Payload stored in JWT token and attached to request\n */\nexport interface JwtPayload {\n  sub: string; // User ID\n  email: string;\n  iat?: number;\n  exp?: number;\n}\n\n/**\n * Extended request with user attached by JWT guard\n */\nexport interface RequestWithUser extends Request {\n  user: JwtPayload;\n}\n\n/**\n * Decorator to extract current user from request.\n * Must be used after JwtAuthGuard.\n *\n * @example\n * ```typescript\n * @Get('profile')\n * @UseGuards(JwtAuthGuard)\n * getProfile(@CurrentUser() user: JwtPayload) {\n *   return user;\n * }\n *\n * // Get only user ID\n * @Get('profile')\n * @UseGuards(JwtAuthGuard)\n * getProfile(@CurrentUser('sub') userId: string) {\n *   return userId;\n * }\n * ```\n */\nexport const CurrentUser = createParamDecorator(\n  (data: keyof JwtPayload | undefined, ctx: ExecutionContext) => {\n    const request = ctx.switchToHttp().getRequest<RequestWithUser>();\n    const user = request.user;\n\n    if (!user) {\n      return null;\n    }\n\n    return data ? user[data] : user;\n  },\n);"],"names":["CurrentUser","createParamDecorator","data","ctx","request","switchToHttp","getRequest","user"],"mappings":";;;;+BAwCaA;;;eAAAA;;;wBAxC0C;AAwChD,MAAMA,cAAcC,IAAAA,4BAAoB,EAC7C,CAACC,MAAoCC;IACnC,MAAMC,UAAUD,IAAIE,YAAY,GAAGC,UAAU;IAC7C,MAAMC,OAAOH,QAAQG,IAAI;IAEzB,IAAI,CAACA,MAAM;QACT,OAAO;IACT;IAEA,OAAOL,OAAOK,IAAI,CAACL,KAAK,GAAGK;AAC7B"}