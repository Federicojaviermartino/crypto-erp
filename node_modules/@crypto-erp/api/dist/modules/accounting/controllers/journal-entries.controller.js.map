{"version":3,"sources":["../../../../src/modules/accounting/controllers/journal-entries.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Put,\n  Patch,\n  Delete,\n  Body,\n  Param,\n  Query,\n  UseGuards,\n  HttpCode,\n  HttpStatus,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiParam,\n} from '@nestjs/swagger';\nimport { JwtAuthGuard, TenantGuard } from '../../../common/guards/index.js';\nimport { CurrentCompany, CurrentUser } from '../../../common/decorators/index.js';\nimport { JournalEntriesService } from '../services/index.js';\nimport { CreateJournalEntryDto, QueryJournalEntriesDto } from '../dto/index.js';\n\ninterface JwtPayload {\n  sub: string;\n  email: string;\n}\n\n@ApiTags('Journal Entries')\n@ApiBearerAuth()\n@UseGuards(JwtAuthGuard, TenantGuard)\n@Controller('journal-entries')\nexport class JournalEntriesController {\n  constructor(private readonly journalEntriesService: JournalEntriesService) {}\n\n  @Get()\n  @ApiOperation({ summary: 'List all journal entries' })\n  @ApiResponse({ status: 200, description: 'Returns paginated list of journal entries' })\n  async findAll(\n    @CurrentCompany() companyId: string,\n    @Query() query: QueryJournalEntriesDto,\n  ) {\n    return this.journalEntriesService.findAll(companyId, query);\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get journal entry by ID' })\n  @ApiParam({ name: 'id', description: 'Journal entry ID' })\n  @ApiResponse({ status: 200, description: 'Returns journal entry details with lines' })\n  @ApiResponse({ status: 404, description: 'Journal entry not found' })\n  async findById(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ) {\n    return this.journalEntriesService.findById(companyId, id);\n  }\n\n  @Post()\n  @ApiOperation({ summary: 'Create a new journal entry' })\n  @ApiResponse({ status: 201, description: 'Journal entry created successfully' })\n  @ApiResponse({ status: 400, description: 'Invalid data or unbalanced entry' })\n  async create(\n    @CurrentCompany() companyId: string,\n    @CurrentUser() user: JwtPayload,\n    @Body() dto: CreateJournalEntryDto,\n  ) {\n    return this.journalEntriesService.create(companyId, user.sub, dto);\n  }\n\n  @Put(':id')\n  @ApiOperation({ summary: 'Update a journal entry' })\n  @ApiParam({ name: 'id', description: 'Journal entry ID' })\n  @ApiResponse({ status: 200, description: 'Journal entry updated successfully' })\n  @ApiResponse({ status: 404, description: 'Journal entry not found' })\n  @ApiResponse({ status: 409, description: 'Cannot modify posted entry' })\n  async update(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n    @Body() dto: Partial<CreateJournalEntryDto>,\n  ) {\n    return this.journalEntriesService.update(companyId, id, dto);\n  }\n\n  @Patch(':id/post')\n  @ApiOperation({ summary: 'Post a journal entry' })\n  @ApiParam({ name: 'id', description: 'Journal entry ID' })\n  @ApiResponse({ status: 200, description: 'Journal entry posted successfully' })\n  @ApiResponse({ status: 404, description: 'Journal entry not found' })\n  @ApiResponse({ status: 409, description: 'Entry already posted or voided' })\n  @HttpCode(HttpStatus.OK)\n  async post(\n    @CurrentCompany() companyId: string,\n    @CurrentUser() user: JwtPayload,\n    @Param('id') id: string,\n  ) {\n    return this.journalEntriesService.post(companyId, id, user.sub);\n  }\n\n  @Patch(':id/void')\n  @ApiOperation({ summary: 'Void a journal entry' })\n  @ApiParam({ name: 'id', description: 'Journal entry ID' })\n  @ApiResponse({ status: 200, description: 'Journal entry voided successfully' })\n  @ApiResponse({ status: 404, description: 'Journal entry not found' })\n  @ApiResponse({ status: 409, description: 'Entry already voided' })\n  @HttpCode(HttpStatus.OK)\n  async void(\n    @CurrentCompany() companyId: string,\n    @CurrentUser() user: JwtPayload,\n    @Param('id') id: string,\n  ) {\n    return this.journalEntriesService.void(companyId, id, user.sub);\n  }\n\n  @Delete(':id')\n  @ApiOperation({ summary: 'Delete a draft journal entry' })\n  @ApiParam({ name: 'id', description: 'Journal entry ID' })\n  @ApiResponse({ status: 204, description: 'Journal entry deleted successfully' })\n  @ApiResponse({ status: 404, description: 'Journal entry not found' })\n  @ApiResponse({ status: 409, description: 'Only draft entries can be deleted' })\n  @HttpCode(HttpStatus.NO_CONTENT)\n  async delete(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ) {\n    await this.journalEntriesService.delete(companyId, id);\n  }\n}\n"],"names":["JournalEntriesController","findAll","companyId","query","journalEntriesService","findById","id","create","user","dto","sub","update","post","void","delete","summary","status","description","name","OK","NO_CONTENT"],"mappings":";;;;+BAmCaA;;;eAAAA;;;wBAtBN;yBAOA;uBACmC;wBACE;wBACN;wBACwB;;;;;;;;;;;;;;;AAWvD,IAAA,AAAMA,2BAAN,MAAMA;IAGX,MAGMC,QACJ,AAAkBC,SAAiB,EACnC,AAASC,KAA6B,EACtC;QACA,OAAO,IAAI,CAACC,qBAAqB,CAACH,OAAO,CAACC,WAAWC;IACvD;IAEA,MAKME,SACJ,AAAkBH,SAAiB,EACnC,AAAaI,EAAU,EACvB;QACA,OAAO,IAAI,CAACF,qBAAqB,CAACC,QAAQ,CAACH,WAAWI;IACxD;IAEA,MAIMC,OACJ,AAAkBL,SAAiB,EACnC,AAAeM,IAAgB,EAC/B,AAAQC,GAA0B,EAClC;QACA,OAAO,IAAI,CAACL,qBAAqB,CAACG,MAAM,CAACL,WAAWM,KAAKE,GAAG,EAAED;IAChE;IAEA,MAMME,OACJ,AAAkBT,SAAiB,EACnC,AAAaI,EAAU,EACvB,AAAQG,GAAmC,EAC3C;QACA,OAAO,IAAI,CAACL,qBAAqB,CAACO,MAAM,CAACT,WAAWI,IAAIG;IAC1D;IAEA,MAOMG,KACJ,AAAkBV,SAAiB,EACnC,AAAeM,IAAgB,EAC/B,AAAaF,EAAU,EACvB;QACA,OAAO,IAAI,CAACF,qBAAqB,CAACQ,IAAI,CAACV,WAAWI,IAAIE,KAAKE,GAAG;IAChE;IAEA,MAOMG,KACJ,AAAkBX,SAAiB,EACnC,AAAeM,IAAgB,EAC/B,AAAaF,EAAU,EACvB;QACA,OAAO,IAAI,CAACF,qBAAqB,CAACS,IAAI,CAACX,WAAWI,IAAIE,KAAKE,GAAG;IAChE;IAEA,MAOMI,OACJ,AAAkBZ,SAAiB,EACnC,AAAaI,EAAU,EACvB;QACA,MAAM,IAAI,CAACF,qBAAqB,CAACU,MAAM,CAACZ,WAAWI;IACrD;IA5FA,YAAY,AAAiBF,qBAA4C,CAAE;aAA9CA,wBAAAA;IAA+C;AA6F9E;;;;QA1FkBW,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QASzBF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QACtBD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;QASzBF,SAAS;;;QACVC,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;;QAUzBF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QACtBD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;;;;;;;;;;;;;;QAUzBF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QACtBD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;6CACpBE;;;;;;;;;;;;;;;QAULJ,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QACtBD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;6CACpBE;;;;;;;;;;;;;;;QAULJ,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QACtBD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;;QAC1BD,QAAQ;QAAKC,aAAa;;6CACpBG"}