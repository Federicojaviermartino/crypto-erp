{"version":3,"sources":["../../../../src/modules/accounting/controllers/reports.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Query,\n  Param,\n  UseGuards,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiQuery,\n  ApiParam,\n} from '@nestjs/swagger';\nimport { JwtAuthGuard, TenantGuard } from '../../../common/guards/index.js';\nimport { CurrentCompany } from '../../../common/decorators/index.js';\nimport { ReportsService } from '../services/index.js';\nimport { QueryReportsDto } from '../dto/index.js';\n\n@ApiTags('Accounting Reports')\n@ApiBearerAuth()\n@UseGuards(JwtAuthGuard, TenantGuard)\n@Controller('reports')\nexport class ReportsController {\n  constructor(private readonly reportsService: ReportsService) {}\n\n  @Get('trial-balance')\n  @ApiOperation({ summary: 'Generate trial balance report' })\n  @ApiQuery({ name: 'fiscalYearId', required: false, description: 'Filter by fiscal year' })\n  @ApiQuery({ name: 'startDate', required: false, description: 'Start date (YYYY-MM-DD)' })\n  @ApiQuery({ name: 'endDate', required: false, description: 'End date (YYYY-MM-DD)' })\n  @ApiResponse({ status: 200, description: 'Returns trial balance report' })\n  async getTrialBalance(\n    @CurrentCompany() companyId: string,\n    @Query() query: QueryReportsDto,\n  ) {\n    return this.reportsService.getTrialBalance(companyId, {\n      fiscalYearId: query.fiscalYearId,\n      startDate: query.startDate ? new Date(query.startDate) : undefined,\n      endDate: query.endDate ? new Date(query.endDate) : undefined,\n    });\n  }\n\n  @Get('balance-sheet')\n  @ApiOperation({ summary: 'Generate balance sheet report' })\n  @ApiQuery({ name: 'asOfDate', required: false, description: 'As of date (YYYY-MM-DD), defaults to today' })\n  @ApiResponse({ status: 200, description: 'Returns balance sheet report' })\n  async getBalanceSheet(\n    @CurrentCompany() companyId: string,\n    @Query('asOfDate') asOfDate?: string,\n  ) {\n    return this.reportsService.getBalanceSheet(\n      companyId,\n      asOfDate ? new Date(asOfDate) : new Date(),\n    );\n  }\n\n  @Get('income-statement')\n  @ApiOperation({ summary: 'Generate income statement (P&L) report' })\n  @ApiQuery({ name: 'startDate', required: true, description: 'Start date (YYYY-MM-DD)' })\n  @ApiQuery({ name: 'endDate', required: true, description: 'End date (YYYY-MM-DD)' })\n  @ApiResponse({ status: 200, description: 'Returns income statement report' })\n  @ApiResponse({ status: 400, description: 'Missing required date parameters' })\n  async getIncomeStatement(\n    @CurrentCompany() companyId: string,\n    @Query('startDate') startDate: string,\n    @Query('endDate') endDate: string,\n  ) {\n    if (!startDate || !endDate) {\n      return { error: 'Both startDate and endDate are required' };\n    }\n\n    return this.reportsService.getIncomeStatement(\n      companyId,\n      new Date(startDate),\n      new Date(endDate),\n    );\n  }\n\n  @Get('general-ledger/:accountId')\n  @ApiOperation({ summary: 'Generate general ledger report for an account' })\n  @ApiParam({ name: 'accountId', description: 'Account ID' })\n  @ApiQuery({ name: 'startDate', required: false, description: 'Start date (YYYY-MM-DD)' })\n  @ApiQuery({ name: 'endDate', required: false, description: 'End date (YYYY-MM-DD)' })\n  @ApiResponse({ status: 200, description: 'Returns general ledger report' })\n  @ApiResponse({ status: 404, description: 'Account not found' })\n  async getGeneralLedger(\n    @CurrentCompany() companyId: string,\n    @Param('accountId') accountId: string,\n    @Query('startDate') startDate?: string,\n    @Query('endDate') endDate?: string,\n  ) {\n    return this.reportsService.getGeneralLedger(companyId, accountId, {\n      startDate: startDate ? new Date(startDate) : undefined,\n      endDate: endDate ? new Date(endDate) : undefined,\n    });\n  }\n}\n"],"names":["ReportsController","getTrialBalance","companyId","query","reportsService","fiscalYearId","startDate","Date","undefined","endDate","getBalanceSheet","asOfDate","getIncomeStatement","error","getGeneralLedger","accountId","summary","name","required","description","status"],"mappings":";;;;+BAwBaA;;;eAAAA;;;wBAlBN;yBAQA;uBACmC;wBACX;wBACA;wBACC;;;;;;;;;;;;;;;AAMzB,IAAA,AAAMA,oBAAN,MAAMA;IAGX,MAMMC,gBACJ,AAAkBC,SAAiB,EACnC,AAASC,KAAsB,EAC/B;QACA,OAAO,IAAI,CAACC,cAAc,CAACH,eAAe,CAACC,WAAW;YACpDG,cAAcF,MAAME,YAAY;YAChCC,WAAWH,MAAMG,SAAS,GAAG,IAAIC,KAAKJ,MAAMG,SAAS,IAAIE;YACzDC,SAASN,MAAMM,OAAO,GAAG,IAAIF,KAAKJ,MAAMM,OAAO,IAAID;QACrD;IACF;IAEA,MAIME,gBACJ,AAAkBR,SAAiB,EACnC,AAAmBS,QAAiB,EACpC;QACA,OAAO,IAAI,CAACP,cAAc,CAACM,eAAe,CACxCR,WACAS,WAAW,IAAIJ,KAAKI,YAAY,IAAIJ;IAExC;IAEA,MAMMK,mBACJ,AAAkBV,SAAiB,EACnC,AAAoBI,SAAiB,EACrC,AAAkBG,OAAe,EACjC;QACA,IAAI,CAACH,aAAa,CAACG,SAAS;YAC1B,OAAO;gBAAEI,OAAO;YAA0C;QAC5D;QAEA,OAAO,IAAI,CAACT,cAAc,CAACQ,kBAAkB,CAC3CV,WACA,IAAIK,KAAKD,YACT,IAAIC,KAAKE;IAEb;IAEA,MAOMK,iBACJ,AAAkBZ,SAAiB,EACnC,AAAoBa,SAAiB,EACrC,AAAoBT,SAAkB,EACtC,AAAkBG,OAAgB,EAClC;QACA,OAAO,IAAI,CAACL,cAAc,CAACU,gBAAgB,CAACZ,WAAWa,WAAW;YAChET,WAAWA,YAAY,IAAIC,KAAKD,aAAaE;YAC7CC,SAASA,UAAU,IAAIF,KAAKE,WAAWD;QACzC;IACF;IAxEA,YAAY,AAAiBJ,cAA8B,CAAE;aAAhCA,iBAAAA;IAAiC;AAyEhE;;;;QAtEkBY,SAAS;;;QACbC,MAAM;QAAgBC,UAAU;QAAOC,aAAa;;;QACpDF,MAAM;QAAaC,UAAU;QAAOC,aAAa;;;QACjDF,MAAM;QAAWC,UAAU;QAAOC,aAAa;;;QAC5CC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;QAazBH,SAAS;;;QACbC,MAAM;QAAYC,UAAU;QAAOC,aAAa;;;QAC7CC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;QAYzBH,SAAS;;;QACbC,MAAM;QAAaC,UAAU;QAAMC,aAAa;;;QAChDF,MAAM;QAAWC,UAAU;QAAMC,aAAa;;;QAC3CC,QAAQ;QAAKD,aAAa;;;QAC1BC,QAAQ;QAAKD,aAAa;;;;;;;;;;;;;;;;QAkBzBH,SAAS;;;QACbC,MAAM;QAAaE,aAAa;;;QAChCF,MAAM;QAAaC,UAAU;QAAOC,aAAa;;;QACjDF,MAAM;QAAWC,UAAU;QAAOC,aAAa;;;QAC5CC,QAAQ;QAAKD,aAAa;;;QAC1BC,QAAQ;QAAKD,aAAa"}