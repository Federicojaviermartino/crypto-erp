{"version":3,"sources":["../../../../src/modules/accounting/controllers/accounts.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Put,\n  Patch,\n  Body,\n  Param,\n  Query,\n  UseGuards,\n  HttpCode,\n  HttpStatus,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiParam,\n} from '@nestjs/swagger';\nimport { JwtAuthGuard, TenantGuard } from '../../../common/guards/index.js';\nimport { CurrentCompany } from '../../../common/decorators/index.js';\nimport { AccountsService } from '../services/index.js';\nimport { CreateAccountDto, QueryAccountsDto } from '../dto/index.js';\n\n@ApiTags('Accounts')\n@ApiBearerAuth()\n@UseGuards(JwtAuthGuard, TenantGuard)\n@Controller('accounts')\nexport class AccountsController {\n  constructor(private readonly accountsService: AccountsService) {}\n\n  @Get()\n  @ApiOperation({ summary: 'List all accounts' })\n  @ApiResponse({ status: 200, description: 'Returns list of accounts' })\n  async findAll(\n    @CurrentCompany() companyId: string,\n    @Query() query: QueryAccountsDto,\n  ) {\n    return this.accountsService.findAll(companyId, query);\n  }\n\n  @Get('tree')\n  @ApiOperation({ summary: 'Get accounts as hierarchical tree' })\n  @ApiResponse({ status: 200, description: 'Returns account tree structure' })\n  async getTree(@CurrentCompany() companyId: string) {\n    return this.accountsService.findTree(companyId);\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get account by ID' })\n  @ApiParam({ name: 'id', description: 'Account ID' })\n  @ApiResponse({ status: 200, description: 'Returns account details' })\n  @ApiResponse({ status: 404, description: 'Account not found' })\n  async findById(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ) {\n    return this.accountsService.findById(companyId, id);\n  }\n\n  @Get('code/:code')\n  @ApiOperation({ summary: 'Get account by code' })\n  @ApiParam({ name: 'code', description: 'Account code (e.g., 100, 400)' })\n  @ApiResponse({ status: 200, description: 'Returns account details' })\n  @ApiResponse({ status: 404, description: 'Account not found' })\n  async findByCode(\n    @CurrentCompany() companyId: string,\n    @Param('code') code: string,\n  ) {\n    const account = await this.accountsService.findByCode(companyId, code);\n    if (!account) {\n      return { error: 'Account not found', code };\n    }\n    return account;\n  }\n\n  @Get(':id/balance')\n  @ApiOperation({ summary: 'Get account balance' })\n  @ApiParam({ name: 'id', description: 'Account ID' })\n  @ApiResponse({ status: 200, description: 'Returns account balance' })\n  async getBalance(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n    @Query('startDate') startDate?: string,\n    @Query('endDate') endDate?: string,\n  ) {\n    return this.accountsService.getBalance(\n      companyId,\n      id,\n      startDate ? new Date(startDate) : undefined,\n      endDate ? new Date(endDate) : undefined,\n    );\n  }\n\n  @Post()\n  @ApiOperation({ summary: 'Create a new account' })\n  @ApiResponse({ status: 201, description: 'Account created successfully' })\n  @ApiResponse({ status: 409, description: 'Account code already exists' })\n  async create(\n    @CurrentCompany() companyId: string,\n    @Body() dto: CreateAccountDto,\n  ) {\n    return this.accountsService.create(companyId, dto);\n  }\n\n  @Put(':id')\n  @ApiOperation({ summary: 'Update an account' })\n  @ApiParam({ name: 'id', description: 'Account ID' })\n  @ApiResponse({ status: 200, description: 'Account updated successfully' })\n  @ApiResponse({ status: 404, description: 'Account not found' })\n  async update(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n    @Body() dto: Partial<CreateAccountDto>,\n  ) {\n    return this.accountsService.update(companyId, id, dto);\n  }\n\n  @Patch(':id/deactivate')\n  @ApiOperation({ summary: 'Deactivate an account' })\n  @ApiParam({ name: 'id', description: 'Account ID' })\n  @ApiResponse({ status: 200, description: 'Account deactivated' })\n  @HttpCode(HttpStatus.OK)\n  async deactivate(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ) {\n    return this.accountsService.deactivate(companyId, id);\n  }\n\n  @Patch(':id/activate')\n  @ApiOperation({ summary: 'Activate an account' })\n  @ApiParam({ name: 'id', description: 'Account ID' })\n  @ApiResponse({ status: 200, description: 'Account activated' })\n  @HttpCode(HttpStatus.OK)\n  async activate(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ) {\n    return this.accountsService.activate(companyId, id);\n  }\n}\n"],"names":["AccountsController","findAll","companyId","query","accountsService","getTree","findTree","findById","id","findByCode","code","account","error","getBalance","startDate","endDate","Date","undefined","create","dto","update","deactivate","activate","summary","status","description","name","OK"],"mappings":"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"}