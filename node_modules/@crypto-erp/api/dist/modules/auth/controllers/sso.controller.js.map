{"version":3,"sources":["../../../../src/modules/auth/controllers/sso.controller.ts"],"sourcesContent":["import { Controller, Get, Post, Req, Res, UseGuards } from '@nestjs/common';\nimport { AuthGuard } from '@nestjs/passport';\nimport { Request, Response } from 'express';\nimport { AuthService } from '../auth.service';\nimport { ConfigService } from '@nestjs/config';\n\n@Controller('auth/sso')\nexport class SsoController {\n  constructor(\n    private readonly authService: AuthService,\n    private readonly configService: ConfigService,\n  ) {}\n\n  // Google OAuth Login\n  @Get('google')\n  @UseGuards(AuthGuard('google'))\n  async googleLogin() {\n    // Initiates Google OAuth flow\n  }\n\n  @Get('google/callback')\n  @UseGuards(AuthGuard('google'))\n  async googleCallback(@Req() req: Request, @Res() res: Response) {\n    const user = req.user as any;\n\n    // Generate JWT tokens\n    const tokens = await this.authService.generateTokens(user);\n\n    // Redirect to frontend with tokens\n    const frontendUrl = this.configService.get<string>('WEB_URL');\n    const redirectUrl = `${frontendUrl}/auth/callback?token=${tokens.accessToken}&refreshToken=${tokens.refreshToken}`;\n\n    res.redirect(redirectUrl);\n  }\n\n  // Azure AD Login\n  @Get('azure')\n  @UseGuards(AuthGuard('azure-ad'))\n  async azureLogin() {\n    // Initiates Azure AD OAuth flow\n  }\n\n  @Get('azure/callback')\n  @UseGuards(AuthGuard('azure-ad'))\n  async azureCallback(@Req() req: Request, @Res() res: Response) {\n    const user = req.user as any;\n\n    // Generate JWT tokens\n    const tokens = await this.authService.generateTokens(user);\n\n    // Redirect to frontend with tokens\n    const frontendUrl = this.configService.get<string>('WEB_URL');\n    const redirectUrl = `${frontendUrl}/auth/callback?token=${tokens.accessToken}&refreshToken=${tokens.refreshToken}`;\n\n    res.redirect(redirectUrl);\n  }\n\n  // SAML Login\n  @Get('saml')\n  @UseGuards(AuthGuard('saml'))\n  async samlLogin() {\n    // Initiates SAML flow\n  }\n\n  @Post('saml/callback')\n  @UseGuards(AuthGuard('saml'))\n  async samlCallback(@Req() req: Request, @Res() res: Response) {\n    const user = req.user as any;\n\n    // Generate JWT tokens\n    const tokens = await this.authService.generateTokens(user);\n\n    // Redirect to frontend with tokens\n    const frontendUrl = this.configService.get<string>('WEB_URL');\n    const redirectUrl = `${frontendUrl}/auth/callback?token=${tokens.accessToken}&refreshToken=${tokens.refreshToken}`;\n\n    res.redirect(redirectUrl);\n  }\n\n  // SAML Metadata endpoint (for IdP configuration)\n  @Get('saml/metadata')\n  async samlMetadata(@Res() res: Response) {\n    const metadata = this.authService.getSamlMetadata();\n    res.type('application/xml');\n    res.send(metadata);\n  }\n}\n"],"names":["SsoController","googleLogin","googleCallback","req","res","user","tokens","authService","generateTokens","frontendUrl","configService","get","redirectUrl","accessToken","refreshToken","redirect","azureLogin","azureCallback","samlLogin","samlCallback","samlMetadata","metadata","getSamlMetadata","type","send"],"mappings":";;;;+BAOaA;;;eAAAA;;;wBAP8C;0BACjC;yBACQ;6BACN;wBACE;;;;;;;;;;;;;;;AAGvB,IAAA,AAAMA,gBAAN,MAAMA;IAMX,qBAAqB;IACrB,MAEMC,cAAc;IAClB,8BAA8B;IAChC;IAEA,MAEMC,eAAe,AAAOC,GAAY,EAAE,AAAOC,GAAa,EAAE;QAC9D,MAAMC,OAAOF,IAAIE,IAAI;QAErB,sBAAsB;QACtB,MAAMC,SAAS,MAAM,IAAI,CAACC,WAAW,CAACC,cAAc,CAACH;QAErD,mCAAmC;QACnC,MAAMI,cAAc,IAAI,CAACC,aAAa,CAACC,GAAG,CAAS;QACnD,MAAMC,cAAc,GAAGH,YAAY,qBAAqB,EAAEH,OAAOO,WAAW,CAAC,cAAc,EAAEP,OAAOQ,YAAY,EAAE;QAElHV,IAAIW,QAAQ,CAACH;IACf;IAEA,iBAAiB;IACjB,MAEMI,aAAa;IACjB,gCAAgC;IAClC;IAEA,MAEMC,cAAc,AAAOd,GAAY,EAAE,AAAOC,GAAa,EAAE;QAC7D,MAAMC,OAAOF,IAAIE,IAAI;QAErB,sBAAsB;QACtB,MAAMC,SAAS,MAAM,IAAI,CAACC,WAAW,CAACC,cAAc,CAACH;QAErD,mCAAmC;QACnC,MAAMI,cAAc,IAAI,CAACC,aAAa,CAACC,GAAG,CAAS;QACnD,MAAMC,cAAc,GAAGH,YAAY,qBAAqB,EAAEH,OAAOO,WAAW,CAAC,cAAc,EAAEP,OAAOQ,YAAY,EAAE;QAElHV,IAAIW,QAAQ,CAACH;IACf;IAEA,aAAa;IACb,MAEMM,YAAY;IAChB,sBAAsB;IACxB;IAEA,MAEMC,aAAa,AAAOhB,GAAY,EAAE,AAAOC,GAAa,EAAE;QAC5D,MAAMC,OAAOF,IAAIE,IAAI;QAErB,sBAAsB;QACtB,MAAMC,SAAS,MAAM,IAAI,CAACC,WAAW,CAACC,cAAc,CAACH;QAErD,mCAAmC;QACnC,MAAMI,cAAc,IAAI,CAACC,aAAa,CAACC,GAAG,CAAS;QACnD,MAAMC,cAAc,GAAGH,YAAY,qBAAqB,EAAEH,OAAOO,WAAW,CAAC,cAAc,EAAEP,OAAOQ,YAAY,EAAE;QAElHV,IAAIW,QAAQ,CAACH;IACf;IAEA,iDAAiD;IACjD,MACMQ,aAAa,AAAOhB,GAAa,EAAE;QACvC,MAAMiB,WAAW,IAAI,CAACd,WAAW,CAACe,eAAe;QACjDlB,IAAImB,IAAI,CAAC;QACTnB,IAAIoB,IAAI,CAACH;IACX;IA7EA,YACE,AAAiBd,WAAwB,EACzC,AAAiBG,aAA4B,CAC7C;aAFiBH,cAAAA;aACAG,gBAAAA;IAChB;AA2EL"}