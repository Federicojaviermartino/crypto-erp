import{d as W}from"./chunk-R5763NNK.js";import{a as I,c as V,e as N,l as j,m as k,n as R,r as G}from"./chunk-OE3B74VB.js";import{a as H}from"./chunk-JU2KEDBD.js";import"./chunk-FXBJWTCM.js";import{$a as C,Da as b,Db as A,Fb as F,Gb as B,Ia as v,Ja as x,Ma as L,Na as w,Oa as t,Pa as n,Qa as P,Ra as J,Sa as p,Ta as c,U as y,Za as i,_a as h,aa as M,ba as D,bb as u,cb as g,db as _,fb as O,hb as E,jb as f,ra as s,sa as T,xa as S}from"./chunk-2V2B4KT2.js";import"./chunk-35PI25VP.js";var q=(o,m)=>m.id;function z(o,m){o&1&&(t(0,"div",15),P(1,"span",16),n())}function K(o,m){if(o&1){let e=J();t(0,"button",23),p("click",function(){M(e);let a=c().$implicit,d=c(2);return D(d.postEntry(a))}),i(1,"Publicar"),n()}}function Q(o,m){if(o&1&&(t(0,"tr")(1,"td")(2,"strong"),i(3),n()(),t(4,"td"),i(5),E(6,"date"),n(),t(7,"td"),i(8),n(),t(9,"td",18),i(10),E(11,"number"),n(),t(12,"td",18),i(13),E(14,"number"),n(),t(15,"td")(16,"span",19),i(17),n()(),t(18,"td")(19,"div",20)(20,"button",21),i(21,"Ver"),n(),b(22,K,2,0,"button",22),n()()()),o&2){let e=m.$implicit,r=c(2);s(3),h(e.entryNumber),s(2),h(f(6,9,e.date,"dd/MM/yyyy")),s(3),h(e.description||"-"),s(2),C("",f(11,12,r.getTotalDebit(e),"1.2-2")," \u20AC"),s(3),C("",f(14,15,r.getTotalCredit(e),"1.2-2")," \u20AC"),s(3),v(r.getStatusBadgeClass(e.status)),s(),C(" ",r.getStatusLabel(e.status)," "),s(5),x(22,e.status==="DRAFT"?22:-1)}}function U(o,m){o&1&&(t(0,"tr")(1,"td",24),i(2," No se encontraron asientos "),n()())}function X(o,m){if(o&1&&(t(0,"table",17)(1,"thead")(2,"tr")(3,"th"),i(4,"N\xFAmero"),n(),t(5,"th"),i(6,"Fecha"),n(),t(7,"th"),i(8,"Descripci\xF3n"),n(),t(9,"th",18),i(10,"Debe"),n(),t(11,"th",18),i(12,"Haber"),n(),t(13,"th"),i(14,"Estado"),n(),t(15,"th"),i(16,"Acciones"),n()()(),t(17,"tbody"),L(18,Q,23,18,"tr",null,q,!1,U,3,0,"tr"),n()()),o&2){let e=c();s(18),w(e.entries())}}var oe=(()=>{class o{api;entries=S([]);loading=S(!0);searchTerm="";filterStatus="";startDate="";endDate="";constructor(e){this.api=e}ngOnInit(){this.loadEntries()}loadEntries(){this.loading.set(!0);let e={};this.searchTerm&&(e.search=this.searchTerm),this.filterStatus&&(e.status=this.filterStatus),this.startDate&&(e.startDate=this.startDate),this.endDate&&(e.endDate=this.endDate),this.api.get("/journal-entries",e).subscribe({next:r=>{this.entries.set(r.entries||[]),this.loading.set(!1)},error:()=>{this.loading.set(!1)}})}onSearch(){setTimeout(()=>this.loadEntries(),300)}getTotalDebit(e){return e.lines?.reduce((r,a)=>r+(a.debit||0),0)||0}getTotalCredit(e){return e.lines?.reduce((r,a)=>r+(a.credit||0),0)||0}postEntry(e){this.api.patch(`/journal-entries/${e.id}/post`,{}).subscribe({next:()=>this.loadEntries()})}getStatusBadgeClass(e){return{DRAFT:"badge-warning",POSTED:"badge-success",VOIDED:"badge-danger"}[e]||"badge-secondary"}getStatusLabel(e){return{DRAFT:"Borrador",POSTED:"Publicado",VOIDED:"Anulado"}[e]||e}static \u0275fac=function(r){return new(r||o)(T(H))};static \u0275cmp=y({type:o,selectors:[["app-journal-entries-list"]],standalone:!0,features:[O],decls:27,vars:5,consts:[[1,"page"],[1,"page-header"],[1,"text-muted"],["routerLink","/accounting/journal-entries/new",1,"btn","btn-primary"],[1,"filters","card"],[1,"card-body","d-flex","gap-md"],["type","text","placeholder","Buscar...",1,"form-input",2,"max-width","250px",3,"ngModelChange","ngModel"],[1,"form-select",2,"max-width","150px",3,"ngModelChange","ngModel"],["value",""],["value","DRAFT"],["value","POSTED"],["value","VOIDED"],["type","date",1,"form-input",2,"max-width","150px",3,"ngModelChange","ngModel"],[1,"card"],[1,"card-body",2,"padding","0"],[1,"text-center","p-lg"],[1,"spinner"],[1,"table"],[1,"text-right"],[1,"badge"],[1,"d-flex","gap-sm"],[1,"btn","btn-sm","btn-secondary"],[1,"btn","btn-sm","btn-primary"],[1,"btn","btn-sm","btn-primary",3,"click"],["colspan","7",1,"text-center","text-muted","p-lg"]],template:function(r,a){r&1&&(t(0,"div",0)(1,"header",1)(2,"div")(3,"h1"),i(4,"Asientos Contables"),n(),t(5,"p",2),i(6,"Gestiona los asientos del libro diario"),n()(),t(7,"a",3),i(8," + Nuevo Asiento "),n()(),t(9,"div",4)(10,"div",5)(11,"input",6),_("ngModelChange",function(l){return g(a.searchTerm,l)||(a.searchTerm=l),l}),p("ngModelChange",function(){return a.onSearch()}),n(),t(12,"select",7),_("ngModelChange",function(l){return g(a.filterStatus,l)||(a.filterStatus=l),l}),p("ngModelChange",function(){return a.loadEntries()}),t(13,"option",8),i(14,"Todos"),n(),t(15,"option",9),i(16,"Borrador"),n(),t(17,"option",10),i(18,"Publicado"),n(),t(19,"option",11),i(20,"Anulado"),n()(),t(21,"input",12),_("ngModelChange",function(l){return g(a.startDate,l)||(a.startDate=l),l}),p("ngModelChange",function(){return a.loadEntries()}),n(),t(22,"input",12),_("ngModelChange",function(l){return g(a.endDate,l)||(a.endDate=l),l}),p("ngModelChange",function(){return a.loadEntries()}),n()()(),t(23,"div",13)(24,"div",14),b(25,z,2,0,"div",15)(26,X,21,1),n()()()),r&2&&(s(11),u("ngModel",a.searchTerm),s(),u("ngModel",a.filterStatus),s(9),u("ngModel",a.startDate),s(),u("ngModel",a.endDate),s(3),x(25,a.loading()?25:26))},dependencies:[B,F,A,W,G,k,R,I,j,V,N],styles:[".page[_ngcontent-%COMP%]{padding:var(--spacing-xl)}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:var(--spacing-lg)}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-bottom:var(--spacing-xs)}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.filters[_ngcontent-%COMP%]{margin-bottom:var(--spacing-lg)}"]})}return o})();export{oe as JournalEntriesListComponent};
