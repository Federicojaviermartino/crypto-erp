{"version":3,"sources":["../../../src/common/controllers/health.controller.ts"],"sourcesContent":["import { Controller, Get } from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiResponse } from '@nestjs/swagger';\nimport { PrismaService } from '@crypto-erp/database';\n\n@ApiTags('Health')\n@Controller('health')\nexport class HealthController {\n  constructor(private prisma: PrismaService) {}\n\n  @Get()\n  @ApiOperation({ summary: 'Health check endpoint' })\n  @ApiResponse({ status: 200, description: 'Service is healthy' })\n  @ApiResponse({ status: 503, description: 'Service is unhealthy' })\n  async check() {\n    const startTime = Date.now();\n\n    try {\n      // Check database connection\n      await this.prisma.$queryRaw`SELECT 1`;\n\n      return {\n        status: 'ok',\n        timestamp: new Date().toISOString(),\n        uptime: process.uptime(),\n        responseTime: Date.now() - startTime,\n        checks: {\n          database: 'ok',\n        },\n      };\n    } catch {\n      return {\n        status: 'error',\n        timestamp: new Date().toISOString(),\n        uptime: process.uptime(),\n        responseTime: Date.now() - startTime,\n        checks: {\n          database: 'error',\n        },\n      };\n    }\n  }\n\n  @Get('ready')\n  @ApiOperation({ summary: 'Readiness check endpoint' })\n  @ApiResponse({ status: 200, description: 'Service is ready' })\n  async ready() {\n    return {\n      status: 'ready',\n      timestamp: new Date().toISOString(),\n    };\n  }\n\n  @Get('live')\n  @ApiOperation({ summary: 'Liveness check endpoint' })\n  @ApiResponse({ status: 200, description: 'Service is alive' })\n  async live() {\n    return {\n      status: 'alive',\n      timestamp: new Date().toISOString(),\n    };\n  }\n}\n"],"names":["HealthController","check","startTime","Date","now","prisma","$queryRaw","status","timestamp","toISOString","uptime","process","responseTime","checks","database","ready","live","summary","description"],"mappings":";;;;+BAMaA;;;eAAAA;;;wBANmB;yBACmB;0BACrB;;;;;;;;;;AAIvB,IAAA,AAAMA,mBAAN,MAAMA;IAGX,MAIMC,QAAQ;QACZ,MAAMC,YAAYC,KAAKC,GAAG;QAE1B,IAAI;YACF,4BAA4B;YAC5B,MAAM,IAAI,CAACC,MAAM,CAACC,SAAS,CAAC,QAAQ,CAAC;YAErC,OAAO;gBACLC,QAAQ;gBACRC,WAAW,IAAIL,OAAOM,WAAW;gBACjCC,QAAQC,QAAQD,MAAM;gBACtBE,cAAcT,KAAKC,GAAG,KAAKF;gBAC3BW,QAAQ;oBACNC,UAAU;gBACZ;YACF;QACF,EAAE,OAAM;YACN,OAAO;gBACLP,QAAQ;gBACRC,WAAW,IAAIL,OAAOM,WAAW;gBACjCC,QAAQC,QAAQD,MAAM;gBACtBE,cAAcT,KAAKC,GAAG,KAAKF;gBAC3BW,QAAQ;oBACNC,UAAU;gBACZ;YACF;QACF;IACF;IAEA,MAGMC,QAAQ;QACZ,OAAO;YACLR,QAAQ;YACRC,WAAW,IAAIL,OAAOM,WAAW;QACnC;IACF;IAEA,MAGMO,OAAO;QACX,OAAO;YACLT,QAAQ;YACRC,WAAW,IAAIL,OAAOM,WAAW;QACnC;IACF;IArDA,YAAY,AAAQJ,MAAqB,CAAE;aAAvBA,SAAAA;IAAwB;AAsD9C;;;;QAnDkBY,SAAS;;;QACVV,QAAQ;QAAKW,aAAa;;;QAC1BX,QAAQ;QAAKW,aAAa;;;;;;;;;QA+BzBD,SAAS;;;QACVV,QAAQ;QAAKW,aAAa;;;;;;;;;QASzBD,SAAS;;;QACVV,QAAQ;QAAKW,aAAa"}