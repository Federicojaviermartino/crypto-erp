{"version":3,"sources":["../../../../src/modules/crypto/controllers/wallets.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Put,\n  Delete,\n  Body,\n  Param,\n  UseGuards,\n  HttpCode,\n  HttpStatus,\n} from '@nestjs/common';\nimport {\n  ApiTags,\n  ApiOperation,\n  ApiResponse,\n  ApiBearerAuth,\n  ApiParam,\n} from '@nestjs/swagger';\nimport { JwtAuthGuard, TenantGuard } from '../../../common/guards/index.js';\nimport { CurrentCompany } from '../../../common/decorators/index.js';\nimport { WalletsService, WalletWithBalances } from '../services/wallets.service.js';\nimport { CreateWalletDto, UpdateWalletDto } from '../dto/index.js';\nimport { Wallet } from '@prisma/client';\n\n@ApiTags('Crypto - Wallets')\n@ApiBearerAuth()\n@UseGuards(JwtAuthGuard, TenantGuard)\n@Controller('crypto/wallets')\nexport class WalletsController {\n  constructor(private readonly walletsService: WalletsService) {}\n\n  @Get()\n  @ApiOperation({ summary: 'List all wallets' })\n  @ApiResponse({\n    status: 200,\n    description: 'List of wallets',\n  })\n  async findAll(@CurrentCompany() companyId: string): Promise<{ wallets: Wallet[] }> {\n    const wallets = await this.walletsService.findAll(companyId);\n    return { wallets };\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get wallet by ID' })\n  @ApiParam({ name: 'id', description: 'Wallet ID' })\n  @ApiResponse({\n    status: 200,\n    description: 'Wallet details',\n  })\n  async findById(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ): Promise<Wallet> {\n    return this.walletsService.findById(companyId, id);\n  }\n\n  @Get(':id/balances')\n  @ApiOperation({ summary: 'Get wallet with current balances from blockchain' })\n  @ApiParam({ name: 'id', description: 'Wallet ID' })\n  @ApiResponse({\n    status: 200,\n    description: 'Wallet with current blockchain balances',\n  })\n  async getWithBalances(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ): Promise<WalletWithBalances> {\n    return this.walletsService.getWalletWithBalances(companyId, id);\n  }\n\n  @Get(':id/stats')\n  @ApiOperation({ summary: 'Get wallet statistics' })\n  @ApiParam({ name: 'id', description: 'Wallet ID' })\n  @ApiResponse({\n    status: 200,\n    description: 'Wallet statistics',\n  })\n  async getStats(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ): Promise<{\n    transactionCount: number;\n    lastTransaction: Date | null;\n    uniqueAssets: number;\n  }> {\n    return this.walletsService.getWalletStats(companyId, id);\n  }\n\n  @Post()\n  @ApiOperation({ summary: 'Add a new wallet' })\n  @ApiResponse({\n    status: 201,\n    description: 'Wallet created successfully',\n  })\n  @ApiResponse({\n    status: 409,\n    description: 'Wallet already exists',\n  })\n  async create(\n    @CurrentCompany() companyId: string,\n    @Body() dto: CreateWalletDto,\n  ): Promise<Wallet> {\n    return this.walletsService.create(companyId, dto);\n  }\n\n  @Put(':id')\n  @ApiOperation({ summary: 'Update wallet' })\n  @ApiParam({ name: 'id', description: 'Wallet ID' })\n  @ApiResponse({\n    status: 200,\n    description: 'Wallet updated successfully',\n  })\n  async update(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n    @Body() dto: UpdateWalletDto,\n  ): Promise<Wallet> {\n    return this.walletsService.update(companyId, id, dto);\n  }\n\n  @Delete(':id')\n  @HttpCode(HttpStatus.NO_CONTENT)\n  @ApiOperation({ summary: 'Delete wallet' })\n  @ApiParam({ name: 'id', description: 'Wallet ID' })\n  @ApiResponse({\n    status: 204,\n    description: 'Wallet deleted successfully',\n  })\n  @ApiResponse({\n    status: 409,\n    description: 'Cannot delete wallet with transactions',\n  })\n  async delete(\n    @CurrentCompany() companyId: string,\n    @Param('id') id: string,\n  ): Promise<void> {\n    await this.walletsService.delete(companyId, id);\n  }\n}\n"],"names":["WalletsController","findAll","companyId","wallets","walletsService","findById","id","getWithBalances","getWalletWithBalances","getStats","getWalletStats","create","dto","update","delete","summary","status","description","name","NO_CONTENT"],"mappings":";;;;+BA6BaA;;;eAAAA;;;wBAlBN;yBAOA;uBACmC;wBACX;gCACoB;wBACF;;;;;;;;;;;;;;;AAO1C,IAAA,AAAMA,oBAAN,MAAMA;IAGX,MAMMC,QAAQ,AAAkBC,SAAiB,EAAkC;QACjF,MAAMC,UAAU,MAAM,IAAI,CAACC,cAAc,CAACH,OAAO,CAACC;QAClD,OAAO;YAAEC;QAAQ;IACnB;IAEA,MAOME,SACJ,AAAkBH,SAAiB,EACnC,AAAaI,EAAU,EACN;QACjB,OAAO,IAAI,CAACF,cAAc,CAACC,QAAQ,CAACH,WAAWI;IACjD;IAEA,MAOMC,gBACJ,AAAkBL,SAAiB,EACnC,AAAaI,EAAU,EACM;QAC7B,OAAO,IAAI,CAACF,cAAc,CAACI,qBAAqB,CAACN,WAAWI;IAC9D;IAEA,MAOMG,SACJ,AAAkBP,SAAiB,EACnC,AAAaI,EAAU,EAKtB;QACD,OAAO,IAAI,CAACF,cAAc,CAACM,cAAc,CAACR,WAAWI;IACvD;IAEA,MAUMK,OACJ,AAAkBT,SAAiB,EACnC,AAAQU,GAAoB,EACX;QACjB,OAAO,IAAI,CAACR,cAAc,CAACO,MAAM,CAACT,WAAWU;IAC/C;IAEA,MAOMC,OACJ,AAAkBX,SAAiB,EACnC,AAAaI,EAAU,EACvB,AAAQM,GAAoB,EACX;QACjB,OAAO,IAAI,CAACR,cAAc,CAACS,MAAM,CAACX,WAAWI,IAAIM;IACnD;IAEA,MAYME,OACJ,AAAkBZ,SAAiB,EACnC,AAAaI,EAAU,EACR;QACf,MAAM,IAAI,CAACF,cAAc,CAACU,MAAM,CAACZ,WAAWI;IAC9C;IA5GA,YAAY,AAAiBF,cAA8B,CAAE;aAAhCA,iBAAAA;IAAiC;AA6GhE;;;;QA1GkBW,SAAS;;;QAEvBC,QAAQ;QACRC,aAAa;;;;;;;;;;;;QAQCF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QAEnCD,QAAQ;QACRC,aAAa;;;;;;;;;;;;;;QAUCF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QAEnCD,QAAQ;QACRC,aAAa;;;;;;;;;;;;;;QAUCF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QAEnCD,QAAQ;QACRC,aAAa;;;;;;;;;;;;;;QAcCF,SAAS;;;QAEvBC,QAAQ;QACRC,aAAa;;;QAGbD,QAAQ;QACRC,aAAa;;;;;;;;;;;;;;QAUCF,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QAEnCD,QAAQ;QACRC,aAAa;;;;;;;;;;;;;;;6CAWME;;QACLJ,SAAS;;;QACbG,MAAM;QAAMD,aAAa;;;QAEnCD,QAAQ;QACRC,aAAa;;;QAGbD,QAAQ;QACRC,aAAa"}