import{a}from"./chunk-TRXNC6YO.js";import{a as S,b as I,c as m,f as R,g as k}from"./chunk-R5763NNK.js";import"./chunk-FXBJWTCM.js";import{G as f,Mb as T,Nb as A,Qa as C,R as r,U as l,fb as g,j as c,m as h,pb as v,u,x as d}from"./chunk-2V2B4KT2.js";import"./chunk-35PI25VP.js";var O=()=>{let t=r(a),n=r(m);return t.getAccessToken()?t.currentUser()?!0:t.loadCurrentUser().pipe(d(1),h(e=>e?!0:(n.navigate(["/auth/login"]),!1))):(n.navigate(["/auth/login"]),!1)};var U=()=>{let t=r(a),n=r(m);return t.getAccessToken()?(n.navigate(["/dashboard"]),!1):!0};var E=[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"auth",canActivate:[U],loadChildren:()=>import("./chunk-MQ5P5EJ7.js").then(t=>t.AUTH_ROUTES)},{path:"",canActivate:[O],loadComponent:()=>import("./chunk-VX5RRZZN.js").then(t=>t.MainLayoutComponent),children:[{path:"dashboard",loadComponent:()=>import("./chunk-AN4O3LYN.js").then(t=>t.DashboardComponent)},{path:"accounting",loadChildren:()=>import("./chunk-NTOI5PDK.js").then(t=>t.ACCOUNTING_ROUTES)},{path:"invoicing",loadChildren:()=>import("./chunk-6KQVQIWO.js").then(t=>t.INVOICING_ROUTES)},{path:"crypto",loadChildren:()=>import("./chunk-2I6KYAJI.js").then(t=>t.CRYPTO_ROUTES)},{path:"settings",loadChildren:()=>import("./chunk-VM6INYHI.js").then(t=>t.SETTINGS_ROUTES)},{path:"ai",loadChildren:()=>import("./chunk-CEJ6WCC6.js").then(t=>t.AI_ROUTES)}]},{path:"**",redirectTo:"dashboard"}];var y=(t,n)=>{let o=r(a),e=o.getAccessToken(),i=o.getCompanyId(),p=t.headers;e&&(p=p.set("Authorization",`Bearer ${e}`)),i&&(p=p.set("X-Company-Id",i));let w=t.clone({headers:p});return n(w)};var s=!1,x=(t,n)=>{let o=r(a);return n(t).pipe(u(e=>e.status===401&&!t.url.includes("/auth/")&&!s?(s=!0,o.refreshToken().pipe(f(i=>{if(s=!1,i){let p=t.clone({headers:t.headers.set("Authorization",`Bearer ${i.accessToken}`)});return n(p)}return o.logout(),c(()=>e)}),u(i=>(s=!1,o.logout(),c(()=>i))))):c(()=>e)))};var G={providers:[v({eventCoalescing:!0}),R(E,k()),T(A([y,x]))]};var b=(()=>{class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=l({type:t,selectors:[["app-root"]],standalone:!0,features:[g],decls:1,vars:0,template:function(e,i){e&1&&C(0,"router-outlet")},dependencies:[I],encapsulation:2})}return t})();S(b,G).catch(t=>console.error(t));
