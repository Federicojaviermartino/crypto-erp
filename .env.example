# ============================================================================
# CRYPTO ERP - Environment Variables
# ============================================================================
# Copy this file to .env and fill in your values
# Never commit .env to version control!
# ============================================================================

# ----------------------------------------------------------------------------
# Application
# ----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000
API_URL=http://localhost:3000
WEB_URL=http://localhost:5200

# ----------------------------------------------------------------------------
# Database (PostgreSQL + pgvector)
# ----------------------------------------------------------------------------
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/crypto_erp?schema=public"

# Connection pool settings (production)
# DATABASE_POOL_MIN=2
# DATABASE_POOL_MAX=10
# DATABASE_ACQUIRE_TIMEOUT=30000
# DATABASE_IDLE_TIMEOUT=10000

# Multi-Region Database Configuration (Phase 4)
# Primary region where write operations occur
# DATABASE_PRIMARY_REGION=eu

# Read replicas for different geographic regions (optional)
# DATABASE_READ_REPLICA_EU="postgresql://user:pass@eu-replica:5432/crypto_erp"
# DATABASE_READ_REPLICA_US="postgresql://user:pass@us-replica:5432/crypto_erp"
# DATABASE_READ_REPLICA_ASIA="postgresql://user:pass@asia-replica:5432/crypto_erp"

# ----------------------------------------------------------------------------
# Redis (Cache + Queues)
# ----------------------------------------------------------------------------
REDIS_URL="redis://localhost:6379"
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=

# ----------------------------------------------------------------------------
# Authentication (JWT)
# ----------------------------------------------------------------------------
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-refresh-token-secret-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# Encryption key for 2FA secrets (32 bytes recommended)
ENCRYPTION_KEY=your-32-byte-encryption-key-for-2fa-secrets

# Or use external auth provider
# AUTH_PROVIDER=clerk
# CLERK_SECRET_KEY=sk_test_...
# CLERK_PUBLISHABLE_KEY=pk_test_...

# ----------------------------------------------------------------------------
# AI - Anthropic (Primary LLM)
# ----------------------------------------------------------------------------
ANTHROPIC_API_KEY=sk-ant-api03-...

# ----------------------------------------------------------------------------
# AI - OpenAI (Fallback LLM + Embeddings)
# ----------------------------------------------------------------------------
OPENAI_API_KEY=sk-...

# ----------------------------------------------------------------------------
# AI - Ollama (Self-hosted, optional)
# ----------------------------------------------------------------------------
OLLAMA_BASE_URL=http://localhost:11434
# Default models to pull: llama3.1:8b, mistral:7b

# ----------------------------------------------------------------------------
# AI - Configuration
# ----------------------------------------------------------------------------
# Set to 'true' for enterprise clients requiring total privacy (Ollama only)
AI_PRIVATE_MODE=false

# Primary provider: anthropic | openai | ollama
AI_PRIMARY_PROVIDER=anthropic

# Model overrides (optional)
# AI_CHAT_MODEL=claude-3-5-sonnet-20241022
# AI_CATEGORIZATION_MODEL=claude-3-5-haiku-20241022
# AI_EMBEDDINGS_MODEL=text-embedding-3-small

# ----------------------------------------------------------------------------
# AI - OCR (Multi-provider with fallback chain)
# ----------------------------------------------------------------------------
# 1. Google Cloud Vision (primary, best accuracy but paid)
GOOGLE_CLOUD_API_KEY=your-google-cloud-api-key

# 2. PaddleOCR (self-hosted, free, privacy-focused)
# Start with: docker-compose --profile ocr up -d paddleocr
PADDLE_OCR_URL=http://localhost:8866

# 3. AI-based extraction (fallback, always available)

# ----------------------------------------------------------------------------
# Blockchain APIs
# ----------------------------------------------------------------------------
# Covalent GoldRush (primary blockchain data)
COVALENT_API_KEY=cqt_...

# CoinGecko (crypto prices)
COINGECKO_API_KEY=CG-...
# Note: API key optional for free tier (30 req/min)

# Alternative providers (optional)
# ALCHEMY_API_KEY=...
# MORALIS_API_KEY=...
# INFURA_PROJECT_ID=...

# ----------------------------------------------------------------------------
# Verifactu (Spanish Electronic Invoicing)
# ----------------------------------------------------------------------------
# AEAT digital certificate for invoice transmission
AEAT_CERTIFICATE_PATH=/path/to/certificate.p12
AEAT_CERTIFICATE_PASSWORD=your-certificate-password

# Environment: production | test
AEAT_ENVIRONMENT=test

# Software identification (register with AEAT)
VERIFACTU_SOFTWARE_NAME=CryptoERP
VERIFACTU_SOFTWARE_VERSION=1.0.0
VERIFACTU_SOFTWARE_NIF=B99999999

# ----------------------------------------------------------------------------
# Email (for notifications, optional)
# ----------------------------------------------------------------------------
# SMTP_HOST=smtp.example.com
# SMTP_PORT=587
# SMTP_USER=your-email@example.com
# SMTP_PASSWORD=your-password
# SMTP_FROM="Crypto ERP <noreply@example.com>"

# Or use email service
# SENDGRID_API_KEY=SG.xxx
# RESEND_API_KEY=re_xxx

# ----------------------------------------------------------------------------
# Storage (for file uploads, optional)
# ----------------------------------------------------------------------------
# AWS S3
# AWS_ACCESS_KEY_ID=
# AWS_SECRET_ACCESS_KEY=
# AWS_REGION=eu-west-1
# AWS_S3_BUCKET=crypto-erp-uploads

# Or use local storage
UPLOAD_PATH=./uploads
MAX_FILE_SIZE=10485760

# ----------------------------------------------------------------------------
# Logging & Monitoring
# ----------------------------------------------------------------------------
LOG_LEVEL=debug
# LOG_FORMAT=json

# Sentry (error tracking, optional)
# SENTRY_DSN=https://xxx@sentry.io/xxx

# ----------------------------------------------------------------------------
# Rate Limiting
# ----------------------------------------------------------------------------
RATE_LIMIT_TTL=60
RATE_LIMIT_LIMIT=100

# AI-specific rate limits (per hour)
AI_RATE_LIMIT_CHAT=100
AI_RATE_LIMIT_CATEGORIZATION=1000
AI_RATE_LIMIT_OCR=50

# ----------------------------------------------------------------------------
# Feature Flags
# ----------------------------------------------------------------------------
FEATURE_VERIFACTU_ENABLED=true
FEATURE_CRYPTO_ENABLED=true
FEATURE_AI_CHAT_ENABLED=true
FEATURE_AI_OCR_ENABLED=true
FEATURE_AI_CATEGORIZATION_ENABLED=true

# ----------------------------------------------------------------------------
# Development Only
# ----------------------------------------------------------------------------
# Enable Prisma query logging
# PRISMA_LOG_QUERIES=true

# Disable SSL for local database
# DATABASE_SSL=false

# Mock external APIs
# MOCK_BLOCKCHAIN_API=true
# MOCK_PRICE_API=true

# ----------------------------------------------------------------------------
# Email Notifications (Resend)
# ----------------------------------------------------------------------------
RESEND_API_KEY=re_...
EMAIL_FROM=Crypto-ERP <noreply@crypto-erp.com>

# Alternative: SendGrid
# SENDGRID_API_KEY=SG...

# ----------------------------------------------------------------------------
# Error Tracking (Sentry)
# ----------------------------------------------------------------------------
SENTRY_DSN=https://...@sentry.io/...
# SENTRY_ORG=your-org
# SENTRY_AUTH_TOKEN=...

# ----------------------------------------------------------------------------
# Payments (Stripe)
# ----------------------------------------------------------------------------
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# ----------------------------------------------------------------------------
# Automated Backups
# ----------------------------------------------------------------------------
# Backup schedule (cron format)
BACKUP_SCHEDULE=0 2 * * *

# Backup retention
BACKUP_RETENTION_DAYS=7
BACKUP_RETENTION_WEEKS=4
BACKUP_RETENTION_MONTHS=12

# S3 backup storage (optional)
S3_ENABLED=false
S3_BUCKET=crypto-erp-backups
S3_PREFIX=backups/database
S3_REGION=us-east-1

# Backup notifications
BACKUP_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Monitoring
PROMETHEUS_PUSHGATEWAY=http://pushgateway:9091

# Run initial backup on service startup
RUN_INITIAL_BACKUP=false

# ----------------------------------------------------------------------------
# Monitoring (Grafana)
# ----------------------------------------------------------------------------
GRAFANA_ADMIN_PASSWORD=admin
