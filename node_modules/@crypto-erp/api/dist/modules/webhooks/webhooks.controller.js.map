{"version":3,"sources":["../../../src/modules/webhooks/webhooks.controller.ts"],"sourcesContent":["import {\n  Controller,\n  Get,\n  Post,\n  Body,\n  Patch,\n  Param,\n  Delete,\n  UseGuards,\n  Query,\n} from '@nestjs/common';\nimport { ApiTags, ApiOperation, ApiBearerAuth } from '@nestjs/swagger';\nimport { WebhooksService } from './webhooks.service';\nimport { CreateWebhookSubscriptionDto } from './dto/create-webhook-subscription.dto';\nimport { UpdateWebhookSubscriptionDto } from './dto/update-webhook-subscription.dto';\nimport { JwtAuthGuard } from '../auth/guards/jwt-auth.guard';\nimport { GetCompany } from '../auth/decorators/get-company.decorator';\n\n@ApiTags('webhooks')\n@ApiBearerAuth()\n@Controller('webhooks/subscriptions')\n@UseGuards(JwtAuthGuard)\nexport class WebhooksController {\n  constructor(private readonly webhooksService: WebhooksService) {}\n\n  @Post()\n  @ApiOperation({ summary: 'Create webhook subscription' })\n  create(\n    @GetCompany() companyId: string,\n    @Body() dto: CreateWebhookSubscriptionDto,\n  ) {\n    return this.webhooksService.createSubscription(companyId, dto);\n  }\n\n  @Get()\n  @ApiOperation({ summary: 'List all webhook subscriptions' })\n  findAll(@GetCompany() companyId: string) {\n    return this.webhooksService.findAllByCompany(companyId);\n  }\n\n  @Get(':id')\n  @ApiOperation({ summary: 'Get webhook subscription by ID' })\n  findOne(@Param('id') id: string, @GetCompany() companyId: string) {\n    return this.webhooksService.findOne(id, companyId);\n  }\n\n  @Patch(':id')\n  @ApiOperation({ summary: 'Update webhook subscription' })\n  update(\n    @Param('id') id: string,\n    @GetCompany() companyId: string,\n    @Body() dto: UpdateWebhookSubscriptionDto,\n  ) {\n    return this.webhooksService.updateSubscription(id, companyId, dto);\n  }\n\n  @Delete(':id')\n  @ApiOperation({ summary: 'Delete webhook subscription' })\n  remove(@Param('id') id: string, @GetCompany() companyId: string) {\n    return this.webhooksService.deleteSubscription(id, companyId);\n  }\n\n  @Post(':id/test')\n  @ApiOperation({ summary: 'Send test webhook' })\n  test(@Param('id') id: string, @GetCompany() companyId: string) {\n    return this.webhooksService.testWebhook(id, companyId);\n  }\n\n  @Get(':id/deliveries')\n  @ApiOperation({ summary: 'Get webhook delivery history' })\n  getDeliveries(\n    @Param('id') id: string,\n    @GetCompany() companyId: string,\n    @Query('limit') limit?: number,\n  ) {\n    return this.webhooksService.getDeliveryHistory(id, companyId, limit);\n  }\n}\n"],"names":["WebhooksController","create","companyId","dto","webhooksService","createSubscription","findAll","findAllByCompany","findOne","id","update","updateSubscription","remove","deleteSubscription","test","testWebhook","getDeliveries","limit","getDeliveryHistory","summary"],"mappings":";;;;+BAsBaA;;;eAAAA;;;wBAZN;yBAC8C;iCACrB;8CACa;8CACA;8BAChB;qCACF;;;;;;;;;;;;;;;AAMpB,IAAA,AAAMA,qBAAN,MAAMA;IAKXC,OACE,AAAcC,SAAiB,EAC/B,AAAQC,GAAiC,EACzC;QACA,OAAO,IAAI,CAACC,eAAe,CAACC,kBAAkB,CAACH,WAAWC;IAC5D;IAIAG,QAAQ,AAAcJ,SAAiB,EAAE;QACvC,OAAO,IAAI,CAACE,eAAe,CAACG,gBAAgB,CAACL;IAC/C;IAIAM,QAAQ,AAAaC,EAAU,EAAE,AAAcP,SAAiB,EAAE;QAChE,OAAO,IAAI,CAACE,eAAe,CAACI,OAAO,CAACC,IAAIP;IAC1C;IAIAQ,OACE,AAAaD,EAAU,EACvB,AAAcP,SAAiB,EAC/B,AAAQC,GAAiC,EACzC;QACA,OAAO,IAAI,CAACC,eAAe,CAACO,kBAAkB,CAACF,IAAIP,WAAWC;IAChE;IAIAS,OAAO,AAAaH,EAAU,EAAE,AAAcP,SAAiB,EAAE;QAC/D,OAAO,IAAI,CAACE,eAAe,CAACS,kBAAkB,CAACJ,IAAIP;IACrD;IAIAY,KAAK,AAAaL,EAAU,EAAE,AAAcP,SAAiB,EAAE;QAC7D,OAAO,IAAI,CAACE,eAAe,CAACW,WAAW,CAACN,IAAIP;IAC9C;IAIAc,cACE,AAAaP,EAAU,EACvB,AAAcP,SAAiB,EAC/B,AAAgBe,KAAc,EAC9B;QACA,OAAO,IAAI,CAACb,eAAe,CAACc,kBAAkB,CAACT,IAAIP,WAAWe;IAChE;IArDA,YAAY,AAAiBb,eAAgC,CAAE;aAAlCA,kBAAAA;IAAmC;AAsDlE;;;;QAnDkBe,SAAS;;;;;;;;;;;;;;QASTA,SAAS;;;;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;;;;;QAUTA,SAAS;;;;;;;;;;;;;;QAMTA,SAAS;;;;;;;;;;;;;;QAMTA,SAAS"}